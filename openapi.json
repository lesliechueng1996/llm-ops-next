{"openapi":"3.0.0","info":{"title":"LLM-OPS-NEXT API Documentation","version":"1.0.0"},"components":{"securitySchemes":{"BearerAuth":{"type":"http","scheme":"bearer"}}},"security":[{"BearerAuth":[]}],"paths":{"/api/ai/optimize-prompt":{"post":{"tags":["AI"],"summary":"利用AI优化预设Prompt","description":"传递原始 Prompt，在后端使用 GPT 模型对预设 Prompt 进行优化并输出，该接口为流式事件输出接口，事件为 optimizePrompt，数据为普通响应结构携带 optimizedPrompt 字段。","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["prompt"],"properties":{"prompt":{"type":"string","description":"原始 prompt，类型为字符串，长度不能超过 2000 个字符","maxLength":2000}}}}}},"responses":{"200":{"description":"优化成功","content":{"text/event-stream":{"schema":{"type":"object","properties":{"event":{"type":"string","example":"optimize_prompt"},"data":{"type":"object","properties":{"optimizedPrompt":{"type":"string","description":"优化的 prompt 片段"}}}}}}}}}}},"/api/api-tools/{providerId}":{"delete":{"tags":["API Tools"],"summary":"删除自定义 API 工具提供者","description":"用于删除特定的自定义 API 插件，删除对应的 API 插件后，关联的应用、工作流也无法使用该插件/工具（在应用对话交流、工作流运行之前都会检测对应的 API 插件是否存在，如果被删除了，均会剔除并无法使用）。","parameters":[{"in":"path","name":"providerId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要删除的 API 工具提供商 id，类型为 uuid"}],"responses":{"200":{"description":"删除成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"删除API工具成功"}}}}}}}},"put":{"tags":["API Tools"],"summary":"更新自定义 API 工具提供者","description":"用于更新自定义 API 工具信息，每次更新的时候，在后端都会删除原有工具信息，并记录创建新的工具数据，在后端使用 provider_id+tool_name 唯一标识进行判断，更新时如果同个账号出现重名，则会抛出错误。","parameters":[{"in":"path","name":"providerId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要修改的 API 工具提供商 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name","icon","openapiSchema"],"properties":{"name":{"type":"string","description":"工具提供商的名字，同一个账号下的工具提供商名字必须唯一","maxLength":30},"icon":{"type":"string","description":"工具提供商的 icon 图标，类型为图片 URL 字符串"},"openapiSchema":{"type":"string","description":"符合 OpenAPI 规范的 json 字符串，在字符串中涵盖基础信息、服务"},"headers":{"type":"array","description":"接口附加的请求头信息","items":{"type":"object","properties":{"key":{"type":"string","description":"请求头对应的键"},"value":{"type":"string","description":"请求头对应的值"}}}}}}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"更新API工具成功"}}}}}}}},"get":{"tags":["API Tools"],"summary":"获取指定 API 工具提供者信息","description":"根据传递的工具提供者 id 获取对应的工具提供者详细信息","parameters":[{"in":"path","name":"providerId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要查看的 API 工具提供商 id，类型为 uuid"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"工具提供者的 id"},"name":{"type":"string","description":"工具提供者的名字"},"icon":{"type":"string","description":"工具提供者的 icon 图标地址"},"description":{"type":"string","description":"工具提供者的描述"},"openapiSchema":{"type":"string","description":"符合 OpenAPI 规范的 json 字符串"},"headers":{"type":"array","description":"接口附加的请求头信息","items":{"type":"object","properties":{"key":{"type":"string","description":"请求头对应的键"},"value":{"type":"string","description":"请求头对应的值"}}}},"createdAt":{"type":"integer","description":"该工具提供者的创建时间戳"}}},"message":{"type":"string","example":"获取API工具成功"}}}}}}}}},"/api/api-tools/{providerId}/tools/{toolName}":{"get":{"tags":["API Tools"],"summary":"获取指定 API 工具信息","description":"根据传递的工具提供者 id + 工具的名称查看自定义 API 插件的相关信息，如果没有找到则返回 404 信息","parameters":[{"in":"path","name":"providerId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要查看的 API 工具提供商 id，类型为 uuid"},{"in":"path","name":"toolName","required":true,"schema":{"type":"string"},"description":"需要查看的 API 工具名称，类型为字符串"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"对应工具的 id"},"name":{"type":"string","description":"对应工具的名称（OperationId，操作 id）"},"description":{"type":"string","description":"对应工具的描述信息"},"inputs":{"type":"array","description":"工具的输入信息","items":{"type":"object","properties":{"type":{"type":"string","description":"输入参数的类型，例如 str"},"required":{"type":"boolean","description":"输入参数是否必填"},"name":{"type":"string","description":"输入参数的名称"},"description":{"type":"string","description":"输入参数的描述信息"}}}},"provider":{"type":"object","description":"工具关联的服务提供者信息","properties":{"id":{"type":"string","format":"uuid","description":"工具提供者的 id"},"name":{"type":"string","description":"工具提供者的名称"},"icon":{"type":"string","description":"工具提供者的 icon 图标地址"},"description":{"type":"string","description":"工具提供者的描述信息"},"createdAt":{"type":"number","description":"工具提供者创建时间"},"headers":{"type":"array","description":"工具提供者的请求头列表信息","items":{"type":"object","properties":{"key":{"type":"string","description":"请求头对应的键"},"value":{"type":"string","description":"请求头对应的值"}}}}}}}},"message":{"type":"string","example":"获取API工具成功"}}}}}}}}},"/api/api-tools/openapi-schema/validate":{"post":{"tags":["API Tools"],"summary":"校验 OpenAPI Schema 字符串是否正确","description":"校验传递的 OpenAPI-Schema 字符串是否正确，该接口只校验数据是否符合规则，不校验对应的提供商名字、工具名字等是否唯一","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["openapiSchema"],"properties":{"openapiSchema":{"type":"string","description":"需要校验的 openapi-schema 字符串，该字符串的规则符合项目 OpenAPI-Schema 规范","example":"{\"description\":\"这是一个查询对应英文单词字典的工具\",\"server\":\"https://dict.youdao.com\",\"paths\":{\"/suggest\":{\"get\":{\"description\":\"根据传递的单词查询其字典信息\",\"operationId\":\"YoudaoSuggest\",\"parameters\":[{\"name\":\"q\",\"in\":\"query\",\"description\":\"要检索查询的单词，例如love/computer\",\"required\":true,\"type\":\"string\"},{\"name\":\"doctype\",\"in\":\"query\",\"description\":\"返回的数据类型，支持json和xml两种格式，默认情况下json数据\",\"required\":false,\"type\":\"string\"}]}}}}"}}}}}},"responses":{"200":{"description":"验证成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"验证OpenAPI Schema成功"}}}}}}}}},"/api/api-tools":{"post":{"tags":["API Tools"],"summary":"创建自定义 API 工具提供者","description":"用于将企业现有的 API 服务接入到 LLMOps 项目创建自定义 API 工具，对于该自定义工具，支持 GET+POST 两种 HTTP 方法的 URL 链接，并且对 OpenAPI-Schema 规范进行简化+调整，以让其更适配 LLMOps 项目。","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name","icon","openapiSchema"],"properties":{"name":{"type":"string","description":"工具提供商的名字，同一个账号下的工具提供商名字必须唯一，否则容易识别错误，名字的长度范围是 0-30 个字符","example":"谷歌搜索"},"icon":{"type":"string","description":"工具提供商的 icon 图标，类型为图片 URL 字符串","example":"https://cdn.imooc.com/google.png"},"openapiSchema":{"type":"string","description":"符合 OpenAPI 规范的 json 字符串，在字符串中涵盖基础信息、服务，该数据在后端会进行校验，如果缺少了对应的数据会抛出数据校验错误","example":"{\"description\":\"这是一个查询对应英文单词字典的工具\",\"server\":\"https://dict.youdao.com\",\"paths\":{\"/suggest\":{\"get\":{\"description\":\"根据传递的单词查询其字典信息\",\"operationId\":\"YoudaoSuggest\",\"parameters\":[{\"name\":\"q\",\"in\":\"query\",\"description\":\"要检索查询的单词，例如love/computer\",\"required\":true,\"type\":\"string\"},{\"name\":\"doctype\",\"in\":\"query\",\"description\":\"返回的数据类型，支持json和xml两种格式，默认情况下json数据\",\"required\":false,\"type\":\"string\"}]}}}}"},"headers":{"type":"array","description":"接口附加的请求头信息，类型为列表，列表的每个元素都是一个字典，如果没有请求头信息则传递空列表即可","items":{"type":"object","properties":{"key":{"type":"string","description":"请求头对应的键","example":"Authorization"},"value":{"type":"string","description":"请求头对应的值","example":"Bearer QQYnRFerJTSEcrfB89fw8prOaObmrch8"}}}}}}}}},"responses":{"201":{"description":"创建成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"providerId":{"type":"string","description":"创建的API工具提供商的ID","example":"123e4567-e89b-12d3-a456-426614174000"}}},"message":{"type":"string","example":"创建自定义API插件成功"}}}}}}}},"get":{"tags":["API Tools"],"summary":"获取自定义 API 工具提供者列表","description":"获取特定账号创建的 API 插件/自定义工具信息，该接口携带分页，并支持搜索。","parameters":[{"in":"query","name":"searchWord","schema":{"type":"string"},"description":"搜索词，用于搜索自定义 API 工具，默认为空代表不搜索任何内容"},{"in":"query","name":"currentPage","schema":{"type":"integer","default":1},"description":"当前页数，默认为 1"},{"in":"query","name":"pageSize","schema":{"type":"integer","default":20,"minimum":1,"maximum":50},"description":"每页的数据条数，默认为 20，范围从 1~50"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"list":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"当前工具提供者对应的 id"},"name":{"type":"string","description":"工具提供者的名字"},"icon":{"type":"string","description":"工具提供者对应的 icon 图标地址"},"tools":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"工具的唯一 id"},"description":{"type":"string","description":"工具的描述信息"},"name":{"type":"string","description":"工具的名称"},"inputs":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string","description":"参数的名字"},"description":{"type":"string","description":"参数的描述"},"required":{"type":"boolean","description":"参数是否必填"},"type":{"type":"string","description":"参数的类型"}}}}}}},"description":{"type":"string","description":"工具提供者的描述信息"},"headers":{"type":"array","items":{"type":"object","properties":{"key":{"type":"string","description":"请求头对应的键"},"value":{"type":"string","description":"请求头对应的值"}}}},"createdAt":{"type":"integer","description":"工具提供者的发布时间戳"}}}},"paginator":{"type":"object","properties":{"currentPage":{"type":"integer","description":"当前的页数"},"pageSize":{"type":"integer","description":"每页的条数"},"totalPage":{"type":"integer","description":"总页数"},"totalRecord":{"type":"integer","description":"总记录条数"}}}}},"message":{"type":"string","example":""}}}}}}}}},"/api/apps/{appId}/conversations":{"post":{"tags":["Apps"],"summary":"应用调试对话","description":"用于在编排 AI 应用时进行 debug 调试，在后端会根据草稿配置创建特定的 Agent 从而执行对应的调试信息，该接口为流式事件响应，会逐个输出 Agent 在运行过程中调用的步骤，涵盖：长期记忆召回、知识库检索、智能体推理/观察、工具调用、LLM消息生成、审核、结束响应等，该接口并非最终版，会随着后续多 LLM 以及多模态 LLM 的接入进行不断扩展。","parameters":[{"in":"path","name":"appId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要调试的 AI 应用 id，格式为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["query"],"properties":{"query":{"type":"string","description":"用户发起的提问信息","example":"能详细讲解下LLM是什么吗？"}}}}}},"responses":{"200":{"description":"流式事件响应成功","content":{"text/event-stream":{"schema":{"type":"object","properties":{"event":{"type":"string","description":"流式事件的名称，例如：agent_thought(Agent推理)、agent_message(Agent消息)、agent_action(Agent行动/执行工具)、dataset_retrieval(知识库检索)、done(流式事件停止) 等","example":"agent_message"},"data":{"type":"object","description":"流式事件数据，记录当前传递的事件的相关信息","properties":{"id":{"type":"string","format":"uuid","description":"当前观察/Agent 步骤记录的 id，如果传递的多次流式事件属于同一个步骤则 id 一致，格式为 uuid","example":"1550b71a-1444-47ed-a59d-c2f080fbae94"},"conversation_id":{"type":"string","format":"uuid","description":"该次流式事件/Agent 步骤归属的会话 id，类型为 uuid","example":"2d7d3e3f-95c9-4d9d-ba9c-9daaf09cc8a8"},"message_id":{"type":"string","format":"uuid","description":"该次流式事件/Agent 步骤归属的消息 id，类型为 uuid"},"task_id":{"type":"string","format":"uuid","description":"该次流式事件归属的任务 id，该参数用于中断指定的流式事件，当执行该子线程的时候，会在缓存中添加对应的 key，中断流式响应时，会在缓存中删除该 key，从而结束整个流式事件响应","example":"5e7834dc-bbca-4ee5-9591-8f297f5acded"},"thought":{"type":"string","description":"Agent 在当前流式事件下的推理内容，类型为字符串","example":""},"observation":{"type":"string","description":"Agent 观察的内容，一般是工具执行后的结果、知识库的检索结果，类型是字符串，该字段并非最终字段，后续会随着插件功能的集成增多进行相应的调整","example":""},"answer":{"type":"string","description":"Agent 返回的文本答案输出，类型为字符串","example":"LLM 即 Large Language Model，大语言模型，是一种基于深度学习的自然语言处理模型，具有很高的语言理解和生成能力，能够处理各式各样的自然语言任务，例如文本生成、问答、翻译、摘要等。它通过在大量的文本数据上进行训练，学习到语言的模式、结构和语义知识。"},"latency":{"type":"number","format":"float","description":"步骤的执行耗时，单位为毫秒，类型为浮点型","example":8541},"created_at":{"type":"integer","description":"消息记录创建的时间戳，类型为整型","example":1714053834}}}}}}}}}}},"/api/apps/{appId}/copy":{"post":{"tags":["Apps"],"summary":"创建应用副本","description":"该接口用于快速复制指定 Agent 应用，涵盖 Agent 应用的基础信息、草稿配置等内容，同时在复制配置的时候，也会检测对应的草稿配置。","parameters":[{"in":"path","name":"appId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要复制的 Agent 应用 id，类型为 uuid"}],"responses":{"201":{"description":"复制成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"拷贝后的 Agent 应用 id，类型为 uuid"}}},"message":{"type":"string","example":"应用复制成功"}}}}}}}}},"/api/apps/{appId}/draft-app-config":{"get":{"tags":["Apps"],"summary":"获取特定应用的草稿配置信息","description":"该接口用于获取指定应用的配置信息，并且永远只获取草稿配置，在创建应用的时候会同步创建草稿信息，并且在应用发布亦或者更新的时候，均会同步配置信息到草稿配置中，并且每次获取草稿配置的时候，都会检测关联的 `知识库`、`工具`、`工作流` 是否存在，如果不存在，则会清除对应数据后返回。","parameters":[{"in":"path","name":"appId","required":true,"schema":{"type":"string","format":"uuid"},"description":"应用 id，类型为 uuid"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"应用配置 id，类型为 uuid"},"modelConfig":{"type":"object","description":"大语言模型配置，存储了 LLM 相关的配置信息","properties":{"provider":{"type":"string","description":"模型提供者名字，例如 openai、moonshot，后端会根据不同的提供商名字获取不同的服务"},"model":{"type":"string","description":"模型名字，例如 gpt-4o-mini 等"},"parameters":{"type":"object","description":"大模型运行参数信息，每个 LLM 均有差异，一般都携带 temperature、top_p、presence_penalty、frequency_penalty、max_tokens 等内容"}}},"dialogRound":{"type":"integer","description":"携带上下上下文轮数，最小为 0，最大为 100，设置该数值后，后端会同时计算不同 LLM 的上下文长度进行取舍"},"presetPrompt":{"type":"string","description":"人设与回复逻辑预设 prompt"},"tools":{"type":"array","description":"应用绑定的工具列表","items":{"type":"object","properties":{"type":{"type":"string","description":"关联工具的类型，值可能为 builtin_tool(内置工具) 或者 api_tool(API工具)"},"provider":{"type":"object","description":"工具提供者信息","properties":{"id":{"type":"string","description":"提供者标识，当类型为内置工具时，id 为名字，当为 API 工具时，id 为 uuid 标识"},"name":{"type":"string","description":"提供者名字"},"label":{"type":"string","description":"提供者标签，如果为 API 工具，则 label 为 name"},"icon":{"type":"string","description":"提供者对应的图标 URL 地址"},"description":{"type":"string","description":"提供者描述信息"}}},"tool":{"type":"object","description":"工具信息","properties":{"id":{"type":"string","description":"工具 uuid，当类型为内置工具时，id 为工具名字，当为 API 工具时，id 为 uuid 标识"},"name":{"type":"string","description":"工具名字"},"label":{"type":"string","description":"工具的标签，如果为 API 工具，则 label 为 name"},"description":{"type":"string","description":"工具描述"},"params":{"type":"object","description":"可选参数，内置工具的 自定义设置 参数，用于初始化对应的工具，如果没有参数时输入为空字典即可"}}}}}},"workflows":{"type":"array","description":"应用绑定的工作流列表","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"关联的工作流 id"},"name":{"type":"string","description":"关联的工作流名字"},"icon":{"type":"string","description":"关联的工作流图标 URL"},"description":{"type":"string","description":"关联的工作流描述"}}}},"datasets":{"type":"array","description":"应用关联的知识库列表，一个应用最多不能关联超过 5 个知识库","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"关联的知识库 id"},"name":{"type":"string","description":"关联知识库的名称"},"icon":{"type":"string","description":"关联知识库的图标 URL 地址"},"description":{"type":"string","description":"关联的知识库描述信息"}}}},"retrievalConfig":{"type":"object","description":"检索配置，记录检索策略、最大召回数量、得分阈值","properties":{"retrievalStrategy":{"type":"string","description":"检索策略，支持的值为 full_text(全文/关键词检索)、semantic(向量/相似性检索)、hybrid(混合检索)"},"k":{"type":"integer","description":"最大召回数量，数据范围为 0-10，必填参数"},"score":{"type":"number","format":"float","description":"最小匹配度，范围从 0-1，保留 2 位小数，数字越大表示相似度越高"}}},"longTermMemory":{"type":"object","description":"长期记忆配置","properties":{"enable":{"type":"boolean","description":"是否启用，true 代表启用，false 代表未启用"}}},"openingStatement":{"type":"string","description":"对话开场白，在初次对话时 Agent 会发送的消息，最大长度不超过 2000"},"openingQuestions":{"type":"array","description":"对话建议问题列表，在初次对话时 Agent 会推送的建议问题，问题数量不超过 3 个","items":{"type":"string"}},"speechToText":{"type":"object","description":"语音输入配置","properties":{"enable":{"type":"boolean","description":"是否启用语音输入，true 代表启用，false 代表未启用"}}},"textToSpeech":{"type":"object","description":"语音输出配置","properties":{"enable":{"type":"boolean","description":"是否启用语音输出，true 代表启用，false 代表未启用"},"voice":{"type":"string","description":"语音输出音色，数据值参考 OpenAI 提供的 TTS 接口提供的音色配置，例如：echo 等"},"autoPlay":{"type":"boolean","description":"是否自动播放，true 代表自动播放，当值为 true 时，WebApp 会在生成完毕时自动调用并获取音频信息随后自动播放（流式播放）"}}},"reviewConfig":{"type":"object","description":"审核配置信息","properties":{"enable":{"type":"boolean","description":"是否启用审核，true 代表启用，false 代表未启用，只有当 enable 为 True 时，inputsConfig 和 outputsConfig 开启才有意义"},"keywords":{"type":"array","description":"审核关键词列表，最多不超过 100 个关键词","items":{"type":"string"}},"inputsConfig":{"type":"object","description":"输入审核配置信息","properties":{"enable":{"type":"boolean","description":"是否启用输入审核，true 代表启用，false 代表未启用"},"presetResponse":{"type":"string","description":"触发输入敏感词时的预设回复，对于输入审核的逻辑，如果存在敏感词，则直接使用预设回复进行相应"}}},"outputsConfig":{"type":"object","description":"输出审核配置信息","properties":{"enable":{"type":"boolean","description":"是否启用输出审核，true 代表启用，false 代表未启用，当值为 true 时，触发敏感词时，会使用 ** 代替特定的敏感词进行输出"}}}}},"updatedAt":{"type":"integer","description":"草稿配置的更新时间，类型为时间戳"},"createdAt":{"type":"integer","description":"草稿配置的创建时间，类型为时间戳"}}},"message":{"type":"string","example":"获取草稿应用配置成功"}}}}}}}},"patch":{"tags":["Apps"],"summary":"更新应用的草稿配置信息","description":"更新应用的草稿配置信息，在前端 UI 页面中，当数据发生更新的时候，会调用该 API 接口将草稿信息同步到对应 Agent 应用的草稿配置中，同时该接口是增量更新，可以只传递需要更新的字段信息。","parameters":[{"in":"path","name":"appId","required":true,"schema":{"type":"string","format":"uuid"},"description":"应用 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"modelConfig":{"type":"object","description":"Agent 应用使用的 LLM 参数信息","properties":{"provider":{"type":"string","description":"模型提供者名字，例如：openai、moonshot 等"},"model":{"type":"string","description":"对应模型提供者下的模型名字，例如：gpt-4o-mini、moonshot-8k 等"},"parameters":{"type":"object","description":"大模型运行参数信息，每个 LLM 均有差异"}}},"dialogRound":{"type":"integer","description":"携带上下上下文轮数，最小为 0，最大为 100"},"presetPrompt":{"type":"string","description":"人设与回复逻辑预设 prompt，最大长度不超过 2000 个字符"},"tools":{"type":"array","description":"应用绑定的工具列表信息","items":{"type":"object","properties":{"type":{"type":"string","description":"工具类型，支持两种值：builtin_tool(内置工具)、api_tool(API工具)"},"providerId":{"type":"string","description":"提供者 id，当为内置工具时，提供者 id 为 provider_name，否则为 id"},"toolId":{"type":"string","description":"工具 id，当为内置工具时，工具 id 为 tool_name，否则为 id"},"params":{"type":"object","description":"内置工具自定义参数，如果为 API工具或者无需设置自定义参数，则值设置为空字典"}}}},"workflows":{"type":"array","description":"应用绑定的工作流 ID 列表","items":{"type":"string","format":"uuid"}},"datasets":{"type":"array","description":"应用绑定的知识库 ID 列表","items":{"type":"string","format":"uuid"}},"retrievalConfig":{"type":"object","description":"检索设置","properties":{"retrievalStrategy":{"type":"string","description":"检索策略，支持的值为 full_text(全文/关键词检索)、semantic(向量/相似性检索)、hybrid(混合检索)"},"k":{"type":"integer","description":"最大召回数量，数据范围为 0-10"},"score":{"type":"number","format":"float","description":"最小匹配度，范围从 0-1，保留 2 位小数"}}},"longTermMemory":{"type":"object","description":"长期记忆配置","properties":{"enable":{"type":"boolean","description":"是否启用，true 代表启用，false 代表未启用"}}},"openingStatement":{"type":"string","description":"对话开场白，在初次对话时 Agent 会发送的消息，最大长度不超过 2000"},"openingQuestions":{"type":"array","description":"对话建议问题列表，在初次对话时 Agent 会推送的建议问题，问题数量不超过 3 个","items":{"type":"string"}},"speechToText":{"type":"object","description":"语音输入配置","properties":{"enable":{"type":"boolean","description":"是否启用语音输入，true 代表启用，false 代表未启用"}}},"textToSpeech":{"type":"object","description":"语音输出配置","properties":{"enable":{"type":"boolean","description":"是否启用语音输出，true 代表启用，false 代表未启用"},"voice":{"type":"string","description":"语音输出音色，数据值参考 OpenAI 提供的 TTS 接口提供的音色配置"},"autoPlay":{"type":"boolean","description":"是否自动播放，true 代表自动播放"}}},"reviewConfig":{"type":"object","description":"审核配置信息","properties":{"enable":{"type":"boolean","description":"是否启用审核，true 代表启用，false 代表未启用"},"keywords":{"type":"array","description":"审核关键词列表，最多不超过 100 个关键词","items":{"type":"string"}},"inputsConfig":{"type":"object","description":"输入审核配置信息","properties":{"enable":{"type":"boolean","description":"是否启用输入审核"},"presetResponse":{"type":"string","description":"触发输入敏感词时的预设回复"}}},"outputsConfig":{"type":"object","description":"输出审核配置信息","properties":{"enable":{"type":"boolean","description":"是否启用输出审核"}}}}}}}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"更新草稿应用配置成功"}}}}}}}}},"/api/apps/{appId}":{"get":{"tags":["Apps"],"summary":"获取应用基础信息","description":"传递对应的应用 id，获取当前应用的基础信息","parameters":[{"in":"path","name":"appId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要获取的应用 id，类型为 uuid"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"应用 id，类型为 uuid"},"debugConversationId":{"type":"string","format":"uuid","description":"调试会话 id，类型为 uuid，如果没有则为空"},"name":{"type":"string","description":"应用名称"},"icon":{"type":"string","description":"应用图标"},"description":{"type":"string","description":"应用描述"},"status":{"type":"string","description":"应用的状态，支持 published(已发布) 和 draft(草稿)"},"draftUpdatedAt":{"type":"integer","description":"应用草稿的更新时间，类型为时间戳，单位为毫秒"},"updatedAt":{"type":"integer","description":"应用的更新时间，类型为时间戳，单位为毫秒"},"createdAt":{"type":"integer","description":"应用的创建时间，类型为时间戳，单位为毫秒"}}},"message":{"type":"string","example":""}}}}}}}},"delete":{"tags":["Apps"],"summary":"删除指定的应用","description":"该接口用于删除指定的 Agent 智能体应用，删除之后，应用无法进行复原与调试，也无法使用开放 API 进行调试、用户无法访问该应用产生的所有会话信息等内容","parameters":[{"in":"path","name":"appId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要删除的应用 id，类型为 uuid"}],"responses":{"200":{"description":"删除成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","description":"空对象"},"message":{"type":"string","example":"删除应用成功"}}}}}}}},"patch":{"tags":["Apps"],"summary":"修改应用基础信息","description":"该接口用于修改指定应用的基础信息，只能修改应用的名字、icon、描述信息","parameters":[{"in":"path","name":"appId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要修改的应用 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","description":"应用名称，长度不超过 40 个字符"},"icon":{"type":"string","description":"应用图标 URL 地址"},"description":{"type":"string","description":"应用描述信息，长度不超过 800 个字符"}}}}}},"responses":{"200":{"description":"修改成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","description":"空对象"},"message":{"type":"string","example":"更新应用成功"}}}}}}}}},"/api/apps/{appId}/summary":{"get":{"tags":["Apps"],"summary":"获取应用调试长记忆","description":"用于获取指定应用的调试长记忆内容，如果该应用并没有开启长记忆，则会抛出错误信息。","parameters":[{"in":"path","name":"appId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要获取长记忆的应用 id，类型为 uuid"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"summary":{"type":"string","description":"该应用最新调试会话的长记忆内容"}}},"message":{"type":"string","example":"获取应用调试长记忆成功"}}}}}}}},"patch":{"tags":["Apps"],"summary":"更新应用调试长记忆","description":"用于更新对应应用的调试长记忆内容，如果应用没有开启长记忆功能，则调用接口会发生报错，如果当前应用没有会话记录时，会先创建一个会话，并更新对应的长记忆。","parameters":[{"in":"path","name":"appId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要更新长记忆的应用 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["summary"],"properties":{"summary":{"type":"string","description":"需要更新的长记忆内容"}}}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"更新应用调试长记忆成功"}}}}}}}}},"/api/apps":{"post":{"tags":["Apps"],"summary":"在个人空间下新增应用","description":"该接口用于在个人空间下新增 Agent 应用，创建的 Agent 应用会添加一个默认的草稿配置信息，默认使用 `openai` 下的 `gpt-4o-mini` 模型，模型的默认参数为：`temperature=0.5`、`top_p=0.85`、`frequency_penalty=0.2`、`presence_penalty=0.2`、`max_tokens=8192`，该参数为相对 `平衡` 的状态。","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name","icon"],"properties":{"name":{"type":"string","description":"Agent 应用的名称，类型为字符串，长度不超过 40 个字符","maxLength":40},"icon":{"type":"string","description":"Agent 应用的图标 URL 地址，类型为字符串"},"description":{"type":"string","description":"Agent 应用的描述信息，类型为字符串，长度不超过 800 个字符","maxLength":800}}}}}},"responses":{"201":{"description":"创建成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"appId":{"type":"string","format":"uuid","description":"创建的 Agent 应用 id，类型为 uuid"}}},"message":{"type":"string","example":"创建应用成功"}}}}}}}},"get":{"tags":["Apps"],"summary":"获取应用分页列表","description":"该接口用于获取当前登录账号下创建的应用分页列表数据，该接口支持分页+搜索。","parameters":[{"in":"query","name":"currentPage","schema":{"type":"integer","default":1},"description":"当前页数，默认为 1"},{"in":"query","name":"pageSize","schema":{"type":"integer","default":20,"minimum":10,"maximum":50},"description":"每页数据条数，默认为 20，范围为 10-50"},{"in":"query","name":"searchWord","schema":{"type":"string"},"description":"搜索词，在后端会使用应用的名称进行模糊匹配"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"list":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"Agent 智能体应用的 id"},"name":{"type":"string","description":"Agent 智能体应用的名字"},"icon":{"type":"string","description":"Agent 智能体应用的图标"},"description":{"type":"string","description":"Agent 智能体应用的描述信息"},"presetPrompt":{"type":"string","description":"Agent 智能体应用的预设提示词，应用如果已发布则从运行配置中获取，否则从草稿配置中获取"},"modelConfig":{"type":"object","properties":{"provider":{"type":"string","description":"模型提供商的名字，例如：openai"},"model":{"type":"string","description":"模型名字，例如 gpt-4o-mini"}}},"status":{"type":"string","enum":["published","draft"],"description":"Agent 智能体应用的状态，支持 published 和 draft，分别代表已发布和草稿"},"updatedAt":{"type":"integer","description":"Agent 智能体的更新时间，类型为时间戳"},"createdAt":{"type":"integer","description":"Agent 智能体的创建时间，类型为时间戳"}}}},"paginator":{"type":"object","properties":{"currentPage":{"type":"integer","description":"当前页数"},"pageSize":{"type":"integer","description":"每页的条数"},"totalPage":{"type":"integer","description":"数据的总页数"},"totalRecord":{"type":"integer","description":"数据的总记录条数"}}}}},"message":{"type":"string","example":""}}}}}}}}},"/api/builtin-tools/{provider}/tools/{tool}":{"get":{"summary":"获取指定工具的信息","description":"根据传递的提供商名称和工具名称获取对应工具信息详情，该接口用于在 AI 应用编排页面，点击工具设置时进行相应的展示","tags":["Builtin Tools"],"parameters":[{"in":"path","name":"provider","required":true,"schema":{"type":"string"},"description":"服务提供商对应的名字，例如 google、dalle 等"},{"in":"path","name":"tool","required":true,"schema":{"type":"string"},"description":"工具的名称，例如 google_serper、dalle3 等"}],"responses":{"200":{"description":"成功获取工具信息","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"provider":{"type":"object","properties":{"name":{"type":"string","description":"提供商的名称"},"label":{"type":"string","description":"提供商对应的标签"},"description":{"type":"string","description":"提供商对应的描述信息"},"category":{"type":"string","description":"提供商对应的分类"},"background":{"type":"string","description":"提供商 icon 图标的背景"},"icon":{"type":"string","description":"提供商 icon 图标"}}},"name":{"type":"string","description":"工具的名字"},"label":{"type":"string","description":"工具的标签"},"description":{"type":"string","description":"工具的描述"},"inputs":{"type":"array","description":"大语言模型调用对应的参数，如果没有则为空列表","items":{"type":"object","properties":{"name":{"type":"string","description":"参数的名字"},"description":{"type":"string","description":"参数的描述"},"required":{"type":"boolean","description":"参数是否必填"},"type":{"type":"string","description":"参数的类型"}}}},"params":{"type":"array","description":"工具设置对应的参数列表信息，如果没有则为空","items":{"type":"object","properties":{"name":{"type":"string","description":"参数的名字"},"label":{"type":"string","description":"参数对应的标签"},"type":{"type":"string","description":"参数的类型，涵盖了 string、number、boolean、select"},"required":{"type":"boolean","description":"参数是否必填"},"default":{"type":"any","description":"参数的默认值，如果没有默认值则为 null"},"min":{"type":"number","description":"参数的最小值，如果不需要则为 null"},"max":{"type":"number","description":"参数的最大值，如果不需要则为 null"},"help":{"type":"string","description":"参数的帮助信息，如果没有则为 null 或者空字符串"},"options":{"type":"array","description":"类型为下拉列表时需要配置的选项","items":{"type":"object","properties":{"value":{"type":"string","description":"下拉菜单对应的值"},"label":{"type":"string","description":"下拉菜单对应的标签"}}}}}}},"createdAt":{"type":"integer","description":"工具的创建时间"}}},"message":{"type":"string","example":""}}}}}}}}},"/api/builtin-tools/categories":{"get":{"summary":"获取内置插件分类列表","description":"用于获取插件广场页面中所有插件的分类信息，该接口不支持分页，会一次性返回所有信息","tags":["Builtin Tools"],"responses":{"200":{"description":"成功获取分类列表","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"array","items":{"type":"object","properties":{"category":{"type":"string","description":"分类英文唯一标识名","example":"search"},"name":{"type":"string","description":"分类名称","example":"搜索"},"icon":{"type":"string","description":"插件分类的 icon 图标 url","example":"https://llm-ops.com/icons/search.svg"}}}},"message":{"type":"string","example":""}}}}}}}}},"/api/builtin-tools":{"get":{"summary":"获取所有内置插件列表信息","description":"获取 LLMOps 项目中所有内置插件列表信息，该接口会一次性获取所有提供商/工具，无分页，适用于 `插件广场` 与 `AI应用编排` 页面。","tags":["Builtin Tools"],"responses":{"200":{"description":"成功获取内置工具列表","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string","description":"提供商的名称"},"label":{"type":"string","description":"提供商对应的标签"},"description":{"type":"string","description":"提供商对应的描述信息"},"category":{"type":"string","description":"提供商对应的分类"},"icon":{"type":"string","description":"提供商 icon 图标"},"background":{"type":"string","description":"提供商 icon 图标的背景"},"tools":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string","description":"工具的名字"},"label":{"type":"string","description":"工具的标签"},"description":{"type":"string","description":"工具的描述"},"inputs":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string","description":"参数的名字"},"description":{"type":"string","description":"参数的描述"},"required":{"type":"boolean","description":"参数是否必填"},"type":{"type":"string","description":"参数的类型"}}}},"params":{"type":"array","items":{"type":"object","properties":{"name":{"type":"string","description":"参数的名字"},"label":{"type":"string","description":"参数对应的标签"},"type":{"type":"string","description":"参数的类型"},"required":{"type":"boolean","description":"参数是否必填"},"default":{"type":"any","description":"参数的默认值"},"min":{"type":"number","description":"参数的最小值"},"max":{"type":"number","description":"参数的最大值"},"help":{"type":"string","description":"参数的帮助信息"},"options":{"type":"array","items":{"type":"object","properties":{"value":{"type":"string","description":"下拉菜单对应的值"},"label":{"type":"string","description":"下拉菜单对应的标签"}}}}}}}}}},"createdAt":{"type":"integer","description":"创建/发布该服务商插件的时间戳"}}}},"message":{"type":"string","example":""}}}}}}}}},"/api/datasets/{datasetId}/documents/{documentId}/enabled":{"patch":{"tags":["Documents"],"summary":"更改指定文档的启用状态","description":"该接口主要用于更改指定文档的启用状态，例如开启或关闭，并且该接口只有在文档状态为 completed(完成) 时才可以做相应的更新调整，否则会抛出错误。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该文档归属的知识库 id，类型为 uuid"},{"in":"path","name":"documentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要更新的文档 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["enabled"],"properties":{"enabled":{"type":"boolean","description":"对应文档的状态，true 为开启，false 为关闭，只有当文档处理完成后，才可以修改，文档如果没有执行完毕，将 enabled 修改为 true，会抛出错误信息"}}}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"更新文档状态成功"}}}}}}}}},"/api/datasets/{datasetId}/documents/{documentId}/name":{"patch":{"tags":["Documents"],"summary":"更新指定文档基础名称","description":"该接口用于更新特定的文档基础信息（文档的名称），在同一个知识库中，文档是可以出现重名的，并且文档更新后的名称长度不能超过100个字符。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该文档归属的知识库 id，类型为 uuid"},{"in":"path","name":"documentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要更新的文档 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name"],"properties":{"name":{"type":"string","description":"需要更新的文档名称，长度不能超过 100 个字符，必填，不能为空，更新的文档名字不必使用对应的扩展，可以任意起名","maxLength":100}}}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"更新文档信息成功"}}}}}}}}},"/api/datasets/{datasetId}/documents/{documentId}":{"get":{"tags":["Documents"],"summary":"获取指定文档基础信息","description":"该接口用于获取指定文档的基础信息，主要用于展示文档片段信息+更新文档信息对应的页面。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该文档归属的知识库 id，类型为 uuid"},{"in":"path","name":"documentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要获取信息的文档 id，类型为 uuid"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"文档的 id，类型为 uuid"},"datasetId":{"type":"string","format":"uuid","description":"文档归属的知识库 id，类型为 uuid"},"name":{"type":"string","description":"文档的名称，类型为字符串"},"segmentCount":{"type":"integer","description":"文档的片段总数，类型为整型"},"characterCount":{"type":"integer","description":"文档的字符数，类型为整型"},"hitCount":{"type":"integer","description":"文档的命中次数，类型为整型"},"position":{"type":"integer","description":"文档的位置，数字越小越靠前（自然排序）"},"enabled":{"type":"boolean","description":"文档的启用状态，true 表示启用，false 表示已禁用（多种原因禁用）"},"disabledAt":{"type":"integer","description":"文档的禁用时间（人为禁用时添加），默认为 0 表示无人工禁用"},"status":{"type":"string","description":"文档的状态，类型为字符串，涵盖 waiting(等待中)、parsing(解析处理中)、splitting(分割中)、indexing(构建索引中)、completed(构建完成)、error(出错) 等，只有当构建完成时 enabled 才起作用"},"error":{"type":"string","description":"错误信息，如果没有错误则为空字符串，当出现错误的时候，在前端 UI 界面可以予以相关提示"},"updatedAt":{"type":"integer","description":"文档的更新时间戳，类型为整型"},"createdAt":{"type":"integer","description":"文档的创建时间戳，类型为整型"}}},"message":{"type":"string","example":""}}}}}}}},"delete":{"tags":["Documents"],"summary":"删除指定文档信息","description":"该接口会根据传递的信息删除文档信息，并删除该文档下的片段信息，同时会将操作同步到向量数据库，在向量数据库中删除归属该文档的所有片段信息，该接口属于耗时接口，所以在后端使用异步任务队列的方式进行操作，完成基础信息的删除（例如文档记录）后，接口即会正常响应前端（删除文档、文档片段、关键词表数据、weaviate数据，同时在删除的时候需要上锁）。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该文档归属的知识库 id，类型为 uuid"},{"in":"path","name":"documentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要删除的文档 id，类型为 uuid"}],"responses":{"200":{"description":"删除成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"删除文档成功"}}}}}}}}},"/api/datasets/{datasetId}/documents/{documentId}/segments/{segmentId}/enabled":{"patch":{"tags":["Segments"],"summary":"更新文档片段的启用状态","description":"该接口主要用于更新文档片段的启用状态，例如 `启用` 或 `禁用`，该接口会同步更新 `业务数据库` 和 `向量数据库`，并且耗时较短，所以无需执行异步任务。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的知识库 id，类型为 uuid"},{"in":"path","name":"documentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的文档 id，类型为 uuid"},{"in":"path","name":"segmentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要修改的片段 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["enabled"],"properties":{"enabled":{"type":"boolean","description":"对应片段的状态，true 为开启，false 为关闭，只有当文档片段处理完成后，才可以修改，文档如果没有执行完毕，将 enabled 修改为 true，会抛出错误信息"}}}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"更新片段启用状态成功"}}}}}}}}},"/api/datasets/{datasetId}/documents/{documentId}/segments/{segmentId}":{"get":{"tags":["Segments"],"summary":"查询文档片段信息","description":"该接口主要用于查询对应的文档片段信息，涵盖了片段内容、关键词、状态、字符数、召回次数、创建时间等内容，并且要求传递的 datasetId、documentId、segmentId 保持一致，否则会抛出错误。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的知识库 id，类型为 uuid"},{"in":"path","name":"documentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的文档 id，类型为 uuid"},{"in":"path","name":"segmentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要查询的片段 id，类型为 uuid"}],"responses":{"200":{"description":"查询成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"文档片段的 id"},"documentId":{"type":"string","format":"uuid","description":"片段归属的文档 id"},"datasetId":{"type":"string","format":"uuid","description":"片段归属的知识库 id"},"position":{"type":"integer","description":"片段在文档内的位置，数字越小越靠前（自然排序）"},"content":{"type":"string","description":"片段的内容"},"keywords":{"type":"array","items":{"type":"string"},"description":"关键词列表"},"characterCount":{"type":"integer","description":"片段的字符串长度"},"tokenCount":{"type":"integer","description":"片段的 token 数"},"hitCount":{"type":"integer","description":"片段被命中的次数"},"hash":{"type":"string","description":"片段内容的哈希值，用于确定唯一的片段内容"},"enabled":{"type":"boolean","description":"片段是否启用，true 表示启用，false 表示禁用"},"disabledAt":{"type":"integer","description":"片段被人为禁用的时间，为 0 表示没有人为禁用"},"status":{"type":"string","description":"片段的状态，涵盖 waiting(等待处理)、indexing(构建索引)、completed(构建完成)、error(错误) 等状态"},"error":{"type":"string","description":"错误信息，当后端程序处理出现错误的时候，会记录错误信息"},"updatedAt":{"type":"integer","description":"片段的最后更新时间"},"createdAt":{"type":"integer","description":"片段的创建时间"}}},"message":{"type":"string","example":"获取片段成功"}}}}}}}},"delete":{"tags":["Segments"],"summary":"删除对应的文档片段信息","description":"该接口用于删除对应的文档片段信息，并且该操作会同步到向量数据库中并行删除，并且由于该接口操作的数据比较少，没有耗时操作，所以无需在后端异步执行，执行完成后接口会正常响应。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的知识库 id，类型为 uuid"},{"in":"path","name":"documentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的文档 id，类型为 uuid"},{"in":"path","name":"segmentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要删除的片段 id，类型为 uuid"}],"responses":{"200":{"description":"删除成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"删除片段成功"}}}}}}}},"patch":{"tags":["Segments"],"summary":"修改文档片段内容","description":"该接口主要用于修改指定的文档片段信息，支持修改内容和关键词，修改的数据会双向同步到业务数据库和向量数据库，并且由于该接口修改的数据比较少，耗时相对较短，所以在后端无需异步处理，操作完成后接口进行响应。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的知识库 id，类型为 uuid"},{"in":"path","name":"documentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的文档 id，类型为 uuid"},{"in":"path","name":"segmentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要修改的片段 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"content":{"type":"string","description":"片段内容，原则上长度不能超过 1000 个 token"},"keywords":{"type":"array","items":{"type":"string"},"description":"片段对应的关键词列表，可选参数，如果该参数没有传，在后端会使用分词服务对片段内容进行分词，得到对应的关键词；传递了参数则不会调用分词服务"}}}}}},"responses":{"200":{"description":"修改成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"修改文档片段信息成功"}}}}}}}}},"/api/datasets/{datasetId}/documents/{documentId}/segments":{"get":{"tags":["Segments"],"summary":"获取指定文档的片段列表","description":"该接口用于获取指定文档的片段列表，该接口支持分页+搜索，搜索模糊匹配片段内容，当搜索词为空时代表不进行任何检索，该接口只要 datasetId、documentId 有任意一个不匹配就会抛出对应的错误。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的知识库 id，类型为 uuid"},{"in":"path","name":"documentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的文档 id，类型为 uuid"},{"in":"query","name":"searchWord","schema":{"type":"string"},"description":"搜索词，用于片段内容模糊搜索，默认为空代表不搜索任何内容"},{"in":"query","name":"currentPage","schema":{"type":"integer","default":1},"description":"当前页数，默认为 1"},{"in":"query","name":"pageSize","schema":{"type":"integer","default":20,"minimum":1,"maximum":50},"description":"每页的数据条数，默认为 20，范围从 1~50"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"list":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"文档片段的 id，类型为 uuid"},"documentId":{"type":"string","format":"uuid","description":"片段归属的文档 id，类型为 uuid"},"datasetId":{"type":"string","format":"uuid","description":"片段归属的知识库 id，类型为 uuid"},"position":{"type":"integer","description":"片段在文档内的位置，数字越小越靠前（自然排序）"},"content":{"type":"string","description":"片段的内容，类型为字符串"},"keywords":{"type":"array","items":{"type":"string"},"description":"关键词列表，列表的元素类型为字符串"},"characterCount":{"type":"integer","description":"片段的字符串长度，类型为整型"},"tokenCount":{"type":"integer","description":"片段的 token 数，类型为整型"},"hitCount":{"type":"integer","description":"片段被命中的次数，类型为整型"},"enabled":{"type":"boolean","description":"片段是否启用，true 表示启用，false 表示禁用（人为禁用或者程序处理异常、未处理完导致的禁用），只有当 status 为 completed(完成) 时，enabled 才有可能为 true"},"disabledAt":{"type":"integer","description":"片段被人为禁用的时间，为 0 表示没有人为禁用，类型为整型"},"status":{"type":"string","description":"片段的状态，涵盖 waiting(等待处理)、indexing(构建索引)、completed(构建完成)、error(错误) 等状态，不同的状态代表不同的处理程度"},"error":{"type":"string","description":"错误信息，类型为字符串，当后端程序处理出现错误的时候，会记录错误信息"},"updatedAt":{"type":"integer","description":"片段的最后更新时间，类型为时间戳"},"createdAt":{"type":"integer","description":"片段的创建时间，类型为时间戳"}}}},"paginator":{"type":"object","properties":{"currentPage":{"type":"integer","description":"当前的页数"},"pageSize":{"type":"integer","description":"每页的条数"},"totalPage":{"type":"integer","description":"总页数"},"totalRecord":{"type":"integer","description":"总记录条数"}}}}},"message":{"type":"string","example":"获取分段列表成功"}}}}}}}},"post":{"tags":["Segments"],"summary":"新增文档片段信息","description":"该接口主要用于在指定文档下新增文档片段信息，添加的片段位置会处于该文档的最后，并且由于每次只能新增一个文档片段，相对来说并不会这么耗时（无需加载分割，直接并行执行关键词提取+文本转向量），所以该接口是同步的，接口会等待处理完毕后再返回，该接口如果任意一个 datasetId 或 documentId 出错，都会抛出对应的错误。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的知识库 id，类型为 uuid"},{"in":"path","name":"documentId","required":true,"schema":{"type":"string","format":"uuid"},"description":"该片段归属的文档 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["content"],"properties":{"content":{"type":"string","description":"片段内容，原则上长度不能超过 1000 个 token，类型为字符串"},"keywords":{"type":"array","items":{"type":"string"},"description":"片段对应的关键词列表，可选参数，如果该参数没有传，在后端会使用分词服务对片段内容进行分词，得到对应的关键词"}}}}}},"responses":{"201":{"description":"创建成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"新创建的片段 id"}}},"message":{"type":"string","example":"创建片段成功"}}}}}}}}},"/api/datasets/{datasetId}/documents/batch/{batchId}":{"get":{"tags":["Documents"],"summary":"根据批处理标识获取处理进度","description":"根据生成的批处理标识查询当前批次下文档的处理进度","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"批处理标识关联的知识库id，类型为 uuid"},{"in":"path","name":"batchId","required":true,"schema":{"type":"string"},"description":"批处理标识，类型为字符串，格式为 %Y%m%d%H%M%S + 随机字符串"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"处理文档的 id，类型为 uuid"},"name":{"type":"string","description":"文档的名字"},"size":{"type":"integer","description":"文档关联的文件大小，单位为字节"},"extension":{"type":"string","description":"文档的扩展名"},"mimeType":{"type":"string","description":"文档的 mimetype 类型推断"},"position":{"type":"integer","description":"文档在知识库中的位置"},"segmentCount":{"type":"integer","description":"该文档下的文档片段数"},"completedSegmentCount":{"type":"integer","description":"该文档下已经处理完成的文档片段数"},"error":{"type":"string","description":"文档片段如果处理出错，会使用该字段记录"},"status":{"type":"string","description":"文档的状态，涵盖 waiting(等待中)、parsing(解析处理中)、splitting(分割中)、indexing(构建索引中)、completed(构建完成)、error(出错) 等内容"},"processingStartedAt":{"type":"integer","description":"开始处理时间，当程序开始处理当前的文档时，会记录该时间，类型为时间戳，下一步为解析，如果没有完成则值为 0，当前的状态为 parsing，一开始的状态为 waiting"},"parsingCompletedAt":{"type":"integer","description":"解析完成时间，当程序加载完当前文档的时候记录的时间，类型为时间戳，下一步为分割，如果没有完成，则值为 0，当前的状态为 splitting，代表下一步需要分割，因为解析已经结束"},"splittingCompletedAt":{"type":"integer","description":"分割完成时间，当程序使用分割器处理完该文档时记录的时间，类型为时间戳，下一步为构建(索引构建+关键词构建)，如果没有完成，则值为 0，当前的状态为 indexing，代表下一步需要构建索引，当前分割已结束"},"indexingCompletedAt":{"type":"integer","description":"构建完成时间，当程序使用 Embeddings 文本嵌入模型以及分词器完成向量转换+关键词提取动作的时候记录的时间，类型为时间戳，该阶段为最后一个阶段，如果没有完成，则值为 0，状态为 completed 代表处理完成"},"completedAt":{"type":"integer","description":"构建完成时间，当程序使用 Embeddings 文本嵌入模型以及分词器完成向量转换+关键词提取动作的时候记录的时间，类型为时间戳，该阶段为最后一个阶段，如果没有完成，则值为 0，状态为 completed 代表处理完成"},"stoppedAt":{"type":"integer","description":"停止时间，类型为时间戳，文档没有正常处理完成的时候，记录的时间，如果没有停止，则值为 0，当前状态为 error，代表出错了"},"createdAt":{"type":"integer","description":"文档的记录创建时间戳"}}}},"message":{"type":"string","example":""}}}}}}}}},"/api/datasets/{datasetId}/documents":{"get":{"tags":["Documents"],"summary":"获取指定知识库的文档列表","description":"用于获取指定知识库下的文档列表，该接口支持搜索+分页，如果传递的搜索词为空代表不搜索任何内容，这里的搜索词使用文档名称进行模糊匹配。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要获取文档列表归属的知识库 id，类型为 uuid"},{"in":"query","name":"searchWord","schema":{"type":"string"},"description":"搜索词，用于模糊匹配搜索文档名称，默认为空代表不搜索任何内容"},{"in":"query","name":"currentPage","schema":{"type":"integer","default":1},"description":"当前页数，默认为 1"},{"in":"query","name":"pageSize","schema":{"type":"integer","default":20,"minimum":1,"maximum":50},"description":"每页的数据条数，默认为 20，范围从 1~50"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"list":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"文档的 id，类型为 uuid"},"name":{"type":"string","description":"文档的名字"},"characterCount":{"type":"integer","description":"文档的字符总数"},"hitCount":{"type":"integer","description":"文档的召回命中次数"},"position":{"type":"integer","description":"文档在知识库中的位置，数字越小越靠前"},"enabled":{"type":"boolean","description":"文档是否开启，如果为 true 则表示开启，false 表示关闭，只有当状态为 completed(构建完成) 时该接口才可以设置为 true"},"disabledAt":{"type":"integer","description":"文档的禁用时间（人为禁用的时候记录），类型为时间戳，如果开启则为 0"},"status":{"type":"string","description":"文档的状态，涵盖 waiting(等待中)、parsing(解析处理中)、splitting(分割中)、indexing(构建索引中)、completed(构建完成)、error(出错) 等"},"error":{"type":"string","description":"错误信息，如果没有错误则为空字符串"},"updatedAt":{"type":"integer","description":"文档的更新时间戳"},"createdAt":{"type":"integer","description":"文档的创建时间戳"}}}},"paginator":{"type":"object","properties":{"currentPage":{"type":"integer","description":"当前的页数"},"pageSize":{"type":"integer","description":"每页的条数"},"totalPage":{"type":"integer","description":"总页数"},"totalRecord":{"type":"integer","description":"总记录条数"}}}}},"message":{"type":"string","example":""}}}}}}}},"post":{"tags":["Documents"],"summary":"在指定知识库下新增文档","description":"该接口用于在指定的知识库下添加新文档，该接口后端的服务会长时间进行处理，所以在后端服务中，创建好基础的文档信息后接口就会响应前端，在前端关闭页面/接口不影响后端逻辑的执行，该接口一次性最多可以上传 10 份文档。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要添加文档的知识库 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["uploadFileIds","processType"],"properties":{"uploadFileIds":{"type":"array","items":{"type":"string","format":"uuid"},"description":"需要新增到知识库中的文件id列表，最多支持上传 10 份文件"},"processType":{"type":"string","enum":["automatic","custom"],"description":"处理类型，支持 automatic(自动模式) 和 custom(自定义)"},"rule":{"type":"object","description":"当处理类型为 custom 时为必填参数","properties":{"preProcessRules":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","enum":["remove_extra_space","remove_url_and_email"],"description":"预处理标识，支持 remove_extra_space(移除多余空格) 和 remove_url_and_email(移除链接和邮箱)"},"enabled":{"type":"boolean","description":"对应的预处理是否开启"}}}},"segment":{"type":"object","properties":{"separators":{"type":"array","items":{"type":"string"},"description":"片段的分隔符列表，支持正则匹配"},"chunkSize":{"type":"integer","description":"每个片段的最大 Token 数"},"chunkOverlap":{"type":"integer","description":"每个片段之间的重叠度"}}}}}}}}}},"responses":{"200":{"description":"创建成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"documents":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"创建的文档 id"},"name":{"type":"string","description":"创建的文档名字"},"status":{"type":"string","description":"当前文档的状态，涵盖 waiting(等待中)、parsing(解析处理中)、splitting(分割中)、indexing(构建索引中)、completed(构建完成)、error(出错) 等"},"createdAt":{"type":"integer","description":"文档的创建时间戳"}}}},"batch":{"type":"string","description":"当前处理的批次标识，可以通过该批次来获取对应文档的处理信息"}}},"message":{"type":"string","example":""}}}}}}}}},"/api/datasets/{datasetId}/hit":{"post":{"tags":["Datasets"],"summary":"指定知识库进行召回测试","description":"使用指定的知识库进行召回测试，用于检测不同的查询 query 在数据库中的检索效果，每次执行召回测试的时候都会将记录存储到最近查询列表中，返回的数据为检索到的文档片段列表。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要进行召回测试的知识库 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["query","retrievalStrategy","k","score"],"properties":{"query":{"type":"string","description":"进行召回测试的查询语句，类型为字符串，长度不超过 200 个字符","maxLength":200},"retrievalStrategy":{"type":"string","description":"检索策略，类型为字符串，支持的值为 full_text(全文/关键词检索)、semantic(向量/相似性检索)、hybrid(混合检索)","enum":["full_text","semantic","hybrid"]},"k":{"type":"integer","description":"最大召回数量，类型为整型，数据范围为 0-10，必填参数","minimum":0,"maximum":10},"score":{"type":"number","format":"float","description":"最小匹配度，类型为浮点型，范围从 0-1，保留 2 位小数，数字越大表示相似度越高","minimum":0,"maximum":1}}}}}},"responses":{"200":{"description":"召回测试成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"文档片段的 id，类型为 uuid"},"document":{"type":"object","description":"片段归属的文档信息","properties":{"id":{"type":"string","format":"uuid","description":"文档 id，类型为 uuid"},"name":{"type":"string","description":"文档的名称，类型为字符串"},"extension":{"type":"string","description":"文档的扩展名"},"mimeType":{"type":"string","description":"文档的 mime_type 类型推断"}}},"datasetId":{"type":"string","format":"uuid","description":"片段归属的知识库id，类型为 uuid"},"score":{"type":"number","format":"float","description":"片段的召回得分，类型为浮点型，数值范围从 0-1，只有检索类型为相似性检索的时候才会返回得分，full_text 和 hybrid 这两种检索策略不会计算召回得分（返回结果为 0）"},"position":{"type":"integer","description":"片段在文档内的位置，数字越小越靠前（自然排序）"},"content":{"type":"string","description":"片段的内容，类型为字符串"},"keywords":{"type":"array","description":"关键词列表，列表的元素类型为字符串","items":{"type":"string"}},"characterCount":{"type":"integer","description":"片段的字符串长度，类型为整型"},"tokenCount":{"type":"integer","description":"片段的 token 数，类型为整型"},"hitCount":{"type":"integer","description":"片段被命中的次数，类型为整型"},"enabled":{"type":"boolean","description":"片段是否启用，true 表示启用，false 表示禁用（人为禁用或者程序处理异常、未处理完导致的禁用），只有当 status 为 completed(完成) 时，enabled 才有可能为 true"},"disabledAt":{"type":"integer","description":"片段被人为禁用的时间，为 0 表示没有人为禁用，类型为整型"},"status":{"type":"string","description":"片段的状态，涵盖 waiting(等待处理)、indexing(构建索引)、completed(构建完成)、error(错误) 等状态，不同的状态代表不同的处理程度","enum":["waiting","indexing","completed","error"]},"error":{"type":"string","description":"错误信息，类型为字符串，当后端程序处理出现错误的时候，会记录错误信息"},"updatedAt":{"type":"integer","description":"片段的最后更新时间，类型为时间戳"},"createdAt":{"type":"integer","description":"片段的创建时间，类型为时间戳"}}}},"message":{"type":"string","example":"召回测试成功"}}}}}}}}},"/api/datasets/{datasetId}/queries":{"get":{"tags":["Datasets"],"summary":"获取指定知识库最近的查询列表","description":"用于获取指定知识库最近的查询列表，该接口会返回最近的 10 条记录，没有分页+搜索功能，返回的数据是按照 createdAt 进行倒序，即数据越新越靠前。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要获取最近查询的知识库 id，类型为 uuid"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"查询的记录 id，类型为 uuid"},"datasetId":{"type":"string","format":"uuid","description":"查询记录关联的知识库 id，类型为 uuid"},"query":{"type":"string","description":"查询的 query 语句，类型为字符串"},"source":{"type":"string","description":"查询的来源信息，支持 Hit Testing(召回测试)、App(AI/Agent应用调用)"},"createdAt":{"type":"integer","description":"查询的时间戳，类型为整型"}}}},"message":{"type":"string","example":""}}}}}}}}},"/api/datasets/{datasetId}":{"put":{"tags":["Datasets"],"summary":"更新指定知识库信息","description":"该接口主要用于更新指定的知识库信息，涵盖：知识库名称、图标、描述等信息。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要更新的知识库 id，类型为 uuid"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name","icon"],"properties":{"name":{"type":"string","maxLength":100,"description":"需要更新的知识库名称，知识库名称也必须保证唯一，长度不能超过 100 个字符"},"icon":{"type":"string","description":"需要更新的知识库图标，类型为图标的 URL 地址"},"description":{"type":"string","maxLength":2000,"description":"需要更新的知识库描述，长度不超过 2000 个字符，如果为空，会先删除原有的描述信息，并且在后端自动生成类似 `Useful for when you want to answer queries about the xxx` 的描述，在后端确保该字段永远不会为空"}}}}}},"responses":{"200":{"description":"更新成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"更新知识库成功"}}}}}}}},"delete":{"tags":["Datasets"],"summary":"删除指定的知识库","description":"用于删除指定的知识库，删除知识库后，在后端会将关联的应用配置、知识库下的所有文档/文档片段/查询语句也进行一并删除（该接口为耗时接口，将使用异步/消息队列的形式来实现），删除后以前关联的应用将无法引用该知识库。","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要删除的知识库 id，类型为 uuid"}],"responses":{"200":{"description":"删除成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"删除知识库成功"}}}}}}}},"get":{"tags":["Datasets"],"summary":"获取指定的知识库详情","description":"用于获取指定的知识库详情信息","parameters":[{"in":"path","name":"datasetId","required":true,"schema":{"type":"string","format":"uuid"},"description":"需要获取的知识库 id，类型为 uuid"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"知识库 id"},"name":{"type":"string","description":"知识库名称"},"icon":{"type":"string","description":"知识库的 icon 图标地址"},"description":{"type":"string","description":"知识库的描述信息"},"documentCount":{"type":"integer","description":"知识库下的文档数量"},"hitCount":{"type":"integer","description":"知识库的文档总命中次数"},"relatedAppCount":{"type":"integer","description":"知识库关联的 AI/Agent 应用数"},"characterCount":{"type":"integer","description":"该知识库拥有的文档的总字符数"},"updatedAt":{"type":"integer","description":"知识库的最后编辑时间"},"createdAt":{"type":"integer","description":"知识库的创建时间"}}},"message":{"type":"string"}}}}}}}}},"/api/datasets":{"get":{"tags":["Datasets"],"summary":"获取知识库列表","description":"用于获取当前登录账号的知识库列表信息，该接口支持搜索+分页，传递搜索词为空时代表不搜索。","parameters":[{"in":"query","name":"searchWord","schema":{"type":"string"},"description":"搜索词，用于知识库名称模糊搜索，默认为空代表不搜索任何内容"},{"in":"query","name":"currentPage","schema":{"type":"integer","default":1},"description":"当前页数，默认为 1"},{"in":"query","name":"pageSize","schema":{"type":"integer","default":20,"minimum":1,"maximum":50},"description":"每页的数据条数，默认为 20，范围从 1~50"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"list":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"知识库对应的 id，类型为 uuid"},"name":{"type":"string","description":"知识库对应的名称"},"icon":{"type":"string","description":"知识库对应的图标"},"description":{"type":"string","description":"知识库描述信息"},"documentCount":{"type":"integer","description":"该知识库下的文档数"},"characterCount":{"type":"integer","description":"该知识库拥有的文档的总字符数"},"relatedAppCount":{"type":"integer","description":"该知识库关联的 APP 数量"},"updatedAt":{"type":"integer","description":"知识库的最近编辑时间，类型为时间戳"},"createdAt":{"type":"integer","description":"知识库的创建时间，类型为时间戳"}}}},"paginator":{"type":"object","properties":{"currentPage":{"type":"integer","description":"当前的页数"},"pageSize":{"type":"integer","description":"每页的条数"},"totalPage":{"type":"integer","description":"总页数"},"totalRecord":{"type":"integer","description":"总记录条数"}}}}},"message":{"type":"string","example":""}}}}}}}},"post":{"tags":["Datasets"],"summary":"创建知识库","description":"根据传递的信息创建知识库，在同一个账号下，只能创建一个同名的知识库，避免在引用的时候发生误解。","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name","icon"],"properties":{"name":{"type":"string","description":"知识库的名称，在同一个账号下，只能创建一个同名的知识库，最长不能超过 100 个字符","maxLength":100},"icon":{"type":"string","description":"知识库的 icon 图标地址，在前端可以调用图片上传接口获取 URL 链接后提交"},"description":{"type":"string","description":"可选参数，知识库的描述信息，描述最大不能超过 2000 个字符，当该参数没有填写时，会自动生成类似 \"Useful for when you want to answer queries about the xxx\" 的描述","maxLength":2000}}}}}},"responses":{"200":{"description":"创建成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"datasetId":{"type":"string","description":"创建的知识库的 ID","example":"123e4567-e89b-12d3-a456-426614174000"}}},"message":{"type":"string","example":"创建知识库成功"}}}}}}}}},"/api/openapi/api-keys/{id}/is-active":{"patch":{"tags":["OpenAPI"],"summary":"修改 API 秘钥状态","description":"该接口用于修改指定 API 秘钥的激活状态","parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"需要修改的 API 秘钥 id"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["isActive"],"properties":{"isActive":{"type":"boolean","description":"秘钥是否激活"}}}}}},"responses":{"200":{"description":"修改成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"修改API秘钥状态成功"}}}}}}}}},"/api/openapi/api-keys/{id}":{"delete":{"tags":["OpenAPI"],"summary":"删除指定的 API 秘钥","description":"该接口用于在后端删除指定的 API 秘钥信息，删除后该秘钥接口无法使用","parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"需要删除的 API 秘钥 id"}],"responses":{"200":{"description":"删除成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"删除API秘钥成功"}}}}}}}},"patch":{"tags":["OpenAPI"],"summary":"修改指定的 API 秘钥","description":"该接口用于修改指定 API 秘钥的基础信息，涵盖是否激活和备注信息","parameters":[{"in":"path","name":"id","required":true,"schema":{"type":"string"},"description":"需要修改的 API 秘钥 id"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["isActive"],"properties":{"isActive":{"type":"boolean","description":"秘钥是否激活"},"remark":{"type":"string","maxLength":100,"description":"接口备注信息"}}}}}},"responses":{"200":{"description":"修改成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"修改API秘钥成功"}}}}}}}}},"/api/openapi/api-keys":{"post":{"summary":"创建 API 秘钥","description":"该接口主要用户在当前登录账号下创建 API 秘钥，API 秘钥可以用于在开放 API 中进行授权并对接 Agent 智能体应用。","tags":["OpenAPI"],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["isActive"],"properties":{"isActive":{"type":"boolean","description":"秘钥是否激活，只有激活的 API 秘钥才可以使用，否则抛出对应的错误"},"remark":{"type":"string","maxLength":100,"description":"接口备注信息"}}}}}},"responses":{"201":{"description":"创建成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"key":{"type":"string","description":"API 秘钥","example":"llmops-v1/k6FINx4SHb1UdqQwprDDA7d52f03d56acae2ae3c69637ac351f5e983507b5"},"isActive":{"type":"boolean","description":"是否激活","example":true}}},"message":{"type":"string","example":"创建API秘钥成功"}}}}}}}},"get":{"summary":"获取 API 秘钥分页列表数据","description":"该接口主要用于获取当前登录账号的 API 秘钥分页列表数据，接口支持分页。","tags":["OpenAPI"],"parameters":[{"in":"query","name":"currentPage","schema":{"type":"integer","default":1},"description":"当前页数"},{"in":"query","name":"pageSize","schema":{"type":"integer","default":20},"description":"每页条数"}],"responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"list":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"API 秘钥对应的 id 数据","example":"d400cec0-892f-49ab-8f72-821b88c1aaa9"},"apiKey":{"type":"string","description":"API 秘钥","example":"llmops-v1/k6FINx4SHb1UdqQwprDDA7d52f03d56acae2ae3c69637ac351f5e983507b5"},"isActive":{"type":"boolean","description":"是否激活，true 代表激活，false 代表禁用","example":true},"remark":{"type":"string","description":"API 秘钥备注信息","example":""},"updatedAt":{"type":"integer","description":"更新时间戳","example":1721460914},"createdAt":{"type":"integer","description":"创建时间戳","example":1721460914}}}},"paginator":{"type":"object","properties":{"currentPage":{"type":"integer","description":"当前的页数","example":1},"pageSize":{"type":"integer","description":"每页的条数","example":20},"totalPage":{"type":"integer","description":"总页数","example":1},"totalRecord":{"type":"integer","description":"总记录条数","example":1}}}}},"message":{"type":"string","example":"获取API秘钥列表成功"}}}}}}}}},"/api/test":{"get":{"tags":["Test"],"summary":"用于测试的接口","description":"用于测试的接口","responses":{"200":{"description":"测试成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":""}}}}}}}}},"/api/upload-files/file":{"post":{"tags":["Upload Files"],"summary":"将文件上传到腾讯云对象存储","description":"该接口主要用于上传文件，调用接口后返回对应的文件 id、名字、云端位置等信息，主要用于知识库、工具、多模态应用对话","requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","required":["file"],"properties":{"file":{"type":"string","format":"binary","description":"需要上传的文件，最多支持上传一个文件，最大支持的文件不能超过 15 MB"}}}}}},"responses":{"201":{"description":"上传成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"上传文件的引用 id，类型为 uuid，在知识库模块、应用对话模块会使用该引用文件 id","example":"46db30d1-3199-4e79-a0cd-abf12fa6858f"},"userId":{"type":"string","format":"uuid","description":"该文件所归属的账号 id，用于标记是哪个账号上传了该文件","example":"e1baf52a-1be2-4b93-ad62-6fad72f1ec37"},"name":{"type":"string","description":"原始文件名字","example":"项目API文档.md"},"key":{"type":"string","description":"云端文件对应的 key 或者路径","example":"2024/05/14/218e5217-ab10-4634-9681-022867955f1b.md"},"size":{"type":"integer","description":"文件大小，单位为字节","example":30241},"extension":{"type":"string","description":"文件的扩展名，例如 .md","example":".md"},"mimeType":{"type":"string","description":"文件 mime-type 类型推断","example":"txt"},"createdAt":{"type":"integer","description":"文件的创建时间戳","example":1721460914}}},"message":{"type":"string","example":"上传文件成功"}}}}}}}}},"/api/upload-files/image":{"post":{"tags":["Upload Files"],"summary":"将图片上传到腾讯云cos","description":"将图片上传到腾讯云 cos 对象存储中，该接口用于需要上传图片的模块，接口会返回图片的 URL 地址","requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"type":"object","properties":{"file":{"type":"string","format":"binary","description":"需要上传的图片文件，支持上传 jpg、jpeg、png、gif，最大不能超过 15 MB"}}}}}},"responses":{"201":{"description":"图片上传成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"imageUrl":{"type":"string","example":"https://cdn.imooc.com/2024/05/14/218e5217-ab10-4634-9681-022867955f1b.png"}}},"message":{"type":"string","example":"图片上传成功"}}}}}}}}},"/api/user/avatar":{"patch":{"tags":["User"],"summary":"修改当前登录账号头像","description":"该接口主要用于修改当前登录账号的头像信息","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["avatar"],"properties":{"avatar":{"type":"string","description":"账号新头像的 URL 地址","example":"https://cdn.imooc.com/2024/05/14/218e5217-ab10-4634-9681-022867955f1b.png"}}}}}},"responses":{"200":{"description":"修改成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"修改头像成功"}}}}}}}}},"/api/user/name":{"patch":{"tags":["User"],"summary":"修改当前登录账号名称","description":"该接口主要用于修改当前登录账号的名称，名称长度在 3-30 个字符","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["name"],"properties":{"name":{"type":"string","description":"新的账号名称，名称长度在 3-30 个字符","example":"泽辉呀"}}}}}},"responses":{"200":{"description":"修改成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"修改用户名成功"}}}}}}}}},"/api/user/password":{"patch":{"tags":["User"],"summary":"修改当前登录账号密码","description":"该接口用于修改当前登录的账号对应的密码，密码的长度在 8-16 位，并且至少包含一个字母、一个数字。","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["password"],"properties":{"password":{"type":"string","description":"账户的新密码，密码的长度在 8-16 位，并且至少包含一个字母、一个数字","example":"imooc.com@zehuiya"}}}}}},"responses":{"200":{"description":"修改成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object"},"message":{"type":"string","example":"修改当前登录账号密码成功"}}}}}}}}},"/api/user":{"get":{"tags":["User"],"summary":"获取当前登录账号信息","description":"该接口主要用于获取当前登录账号的信息，例如 id、账号名称、头像、邮箱等信息","responses":{"200":{"description":"获取成功","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","example":"success"},"data":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"账号 id"},"name":{"type":"string","description":"账号昵称"},"email":{"type":"string","description":"账号邮箱"},"avatar":{"type":"string","description":"账号的头像 URL 地址"},"lastLoginAt":{"type":"integer","description":"账号最后一次登录时间戳（毫秒）"},"lastLoginIp":{"type":"string","description":"账号最后一次登录的 ip 地址"},"createdAt":{"type":"integer","description":"账号的注册时间戳（毫秒）"}}},"message":{"type":"string","example":"获取用户信息成功"}}}}}}}}}},"tags":[]}